<!-- Real-time Campaign Monitor -->
<section class="real-time-monitor">
  <div class="monitor-header">
    <div class="monitor-title">
      <i class="pi pi-eye"></i>
      <span>Real-time Campaign Monitor</span>
    </div>
    <div class="monitor-controls">
      <div class="view-toggle">
        <button [class.active]="viewMode === 'cards'" (click)="viewMode = 'cards'">Cards</button>
        <button [class.active]="viewMode === 'table'" (click)="viewMode = 'table'">Table</button>
      </div>
      <p-dropdown 
        [options]="statusOptions" 
        [(ngModel)]="selectedStatus"
        optionLabel="label"
        optionValue="value"
        placeholder="All Status"
        (onChange)="filterCampaigns()"
        [style]="{'min-width': '120px'}">
      </p-dropdown>
      <p-dropdown 
        [options]="dateOptions" 
        [(ngModel)]="selectedDateFilter"
        optionLabel="label"
        optionValue="value"
        placeholder="Last 7 Days"
        (onChange)="filterCampaigns()"
        [style]="{'min-width': '120px'}">
      </p-dropdown>
    </div>
  </div>

  <!-- Campaign Cards -->
  <div class="monitor-content">
    <div class="campaigns-container" *ngIf="viewMode === 'cards'">
      <div class="campaign-card-item" *ngFor="let campaign of filteredCampaigns">
        <div class="campaign-header">
          <div class="campaign-info">
            <div class="campaign-name">{{campaign.name}}</div>
            <div class="campaign-details">{{campaign.type}} Campaign</div>
          </div>
          <div class="campaign-status">
            <span class="status-badge" [ngClass]="'status-' + campaign.status.toLowerCase()">
              <i [class]="getStatusIcon(campaign.status)"></i>
              {{campaign.status | titlecase}}
            </span>
          </div>
        </div>
        
        <div class="campaign-progress">
          <div class="progress-item">
            <div class="progress-label">Progress</div>
            <div class="progress-bar">
              <div class="progress-fill" [style.width.%]="getProgressPercentage(campaign)"></div>
            </div>
            <div class="progress-percentage">{{getProgressPercentage(campaign)}}%</div>
          </div>
        </div>
        
        <div class="campaign-metrics">
          <div class="metric-row">
            <div class="metric">
              <span class="metric-value">{{campaign.sent | number}}</span>
              <span class="metric-label">Sent</span>
            </div>
            <div class="metric">
              <span class="metric-value">{{campaign.targetAudience | number}}</span>
              <span class="metric-label">Target</span>
            </div>
          </div>
          
          <div class="metric-row">
            <div class="metric">
              <span class="metric-value">â‚¹{{campaign.spent | number}}</span>
              <span class="metric-label">Spent</span>
            </div>
            <div class="metric">
              <span class="metric-value">{{campaign.conversions}}</span>
              <span class="metric-label">Conversions</span>
            </div>
          </div>
          
          <div class="budget-usage">
            <span class="budget-label">Budget Usage</span>
            <div class="budget-bar">
              <div class="budget-fill" [style.width.%]="getBudgetUsagePercentage(campaign)"></div>
            </div>
            <span class="budget-percentage">{{getBudgetUsagePercentage(campaign)}}%</span>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Campaign Details Modal -->
<p-dialog 
  [(visible)]="showCampaignModal"
  [modal]="true"
  [closable]="true"
  [draggable]="false"
  [resizable]="false"
  styleClass="w-11 max-w-4xl"
  (onHide)="closeCampaignModal()">
  
  <ng-template pTemplate="header">
    <div class="flex align-items-center justify-content-between w-full">
      <h2 class="text-xl font-bold m-0">{{selectedCampaign?.name}}</h2>
      <div class="flex align-items-center gap-2">
        <p-tag 
          *ngIf="selectedCampaign"
          [value]="selectedCampaign.status" 
          [ngClass]="getStatusClass(selectedCampaign.status)">
        </p-tag>
      </div>
    </div>
  </ng-template>

  <div *ngIf="selectedCampaign">
    <!-- Campaign Overview Cards -->
    <div class="grid mb-4">
      <div class="col-12 md:col-6 lg:col-3">
        <p-card styleClass="text-center">
          <div class="text-sm font-medium text-600 flex align-items-center justify-content-center mb-1">
            <i class="pi pi-users mr-1"></i>
            Target Audience
          </div>
          <div class="text-2xl font-bold">{{selectedCampaign.targetAudience | number}}</div>
        </p-card>
      </div>
      <div class="col-12 md:col-6 lg:col-3">
        <p-card styleClass="text-center">
          <div class="text-sm font-medium text-600 flex align-items-center justify-content-center mb-1">
            <i class="pi pi-dollar mr-1"></i>
            Total Cost
          </div>
          <div class="text-2xl font-bold">${{selectedCampaign.cost}}</div>
        </p-card>
      </div>
      <div class="col-12 md:col-6 lg:col-3">
        <p-card styleClass="text-center">
          <div class="text-sm font-medium text-600 flex align-items-center justify-content-center mb-1">
            <i class="pi pi-chart-bar mr-1"></i>
            Delivery Rate
          </div>
          <div class="text-2xl font-bold">{{getDeliveryRate(selectedCampaign)}}%</div>
        </p-card>
      </div>
      <div class="col-12 md:col-6 lg:col-3">
        <p-card styleClass="text-center">
          <div class="text-sm font-medium text-600 flex align-items-center justify-content-center mb-1">
            <i class="pi pi-chart-line mr-1"></i>
            Open Rate
          </div>
          <div class="text-2xl font-bold">{{getOpenRate(selectedCampaign)}}%</div>
        </p-card>
      </div>
    </div>

    <!-- Campaign Details -->
    <p-card>
      <div class="grid">
        <div class="col-12 md:col-6">
          <label class="text-sm font-medium text-600 block mb-1">Campaign Type</label>
          <p class="text-900 m-0">{{selectedCampaign.type}}</p>
        </div>
        <div class="col-12 md:col-6">
          <label class="text-sm font-medium text-600 block mb-1">Channels</label>
          <p class="text-900 m-0">{{selectedCampaign.channels.join(', ')}}</p>
        </div>
        <div class="col-12 md:col-6">
          <label class="text-sm font-medium text-600 block mb-1">Created</label>
          <p class="text-900 m-0">{{selectedCampaign.createdAt | date:'medium'}}</p>
        </div>
        <div class="col-12 md:col-6" *ngIf="selectedCampaign.startedAt">
          <label class="text-sm font-medium text-600 block mb-1">Started</label>
          <p class="text-900 m-0">{{selectedCampaign.startedAt | date:'medium'}}</p>
        </div>
      </div>

      <!-- Action Buttons -->
      <div class="mt-4 pt-4 border-top-1 border-200 flex flex-wrap gap-2">
        <p-button 
          label="Edit Campaign" 
          icon="pi pi-pencil"
          styleClass="p-button-outlined p-button-sm">
        </p-button>
        <p-button 
          *ngIf="selectedCampaign.status === 'active'"
          label="Pause Campaign" 
          icon="pi pi-pause"
          styleClass="p-button-outlined p-button-sm"
          (onClick)="toggleCampaignStatus(selectedCampaign)">
        </p-button>
        <p-button 
          *ngIf="selectedCampaign.status === 'paused'"
          label="Resume Campaign" 
          icon="pi pi-play"
          styleClass="p-button-outlined p-button-sm"
          (onClick)="toggleCampaignStatus(selectedCampaign)">
        </p-button>
      </div>
    </p-card>
  </div>
</p-dialog>