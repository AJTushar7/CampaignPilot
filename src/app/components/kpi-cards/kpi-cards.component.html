<!-- Enhanced KPI Cards with Modern Design -->
<div class="grid">
  <div class="col-12 sm:col-6 lg:col" *ngFor="let kpi of kpiMetrics; let i = index">
    <div class="kpi-card custom-card h-full p-4" 
         [class]="'border-l-4 border-' + kpi.color + '-500'"
         style="transition: all 0.3s ease; cursor: pointer;"
         (mouseenter)="$event.currentTarget.style.transform = 'translateY(-4px)'"
         (mouseleave)="$event.currentTarget.style.transform = 'translateY(0)'">
      
      <!-- KPI Card Header -->
      <div class="flex align-items-center justify-content-between mb-3">
        <div class="kpi-icon-wrapper" 
             [class]="'bg-' + kpi.color + '-50 border-round-full p-3'">
          <i class="pi text-xl" [ngClass]="[kpi.icon, 'text-' + kpi.color + '-600']"></i>
        </div>
        <div class="flex align-items-center gap-1" [ngClass]="getTrendColor(kpi.growth)">
          <i class="pi text-sm font-bold" [ngClass]="getTrendIcon(kpi.growth)"></i>
          <span class="text-sm font-bold">{{kpi.growth}}</span>
        </div>
      </div>

      <!-- KPI Data -->
      <div class="kpi-content">
        <div class="kpi-value text-3xl font-bold mb-2" 
             [class]="'text-' + kpi.color + '-700'">
          {{kpi.value}}
        </div>
        <div class="kpi-label text-sm font-medium text-600 mb-2">
          {{kpi.label}}
        </div>
        
        <!-- Progress Visualization -->
        <div class="progress-visualization mt-3">
          <div class="progress-bar bg-surface-200 border-round" style="height: 4px;">
            <div class="progress-fill border-round transition-all transition-duration-500" 
                 [class]="'bg-' + kpi.color + '-500'"
                 [style]="{'width': getProgressWidth(i) + '%'}">
            </div>
          </div>
          <div class="flex justify-content-between mt-1">
            <span class="text-xs text-500">Last Period</span>
            <span class="text-xs text-500">Current</span>
          </div>
        </div>
      </div>

      <!-- Hover Effect Overlay -->
      <div class="absolute inset-0 bg-gradient-to-r opacity-0 hover:opacity-5 transition-opacity"
           [class]="'from-' + kpi.color + '-500 to-' + kpi.color + '-600'">
      </div>
    </div>
  </div>
</div>

<!-- Real-time Update Indicator -->
<div class="flex align-items-center justify-content-center gap-2 mt-3 text-xs text-500" *ngIf="!loading">
  <i class="pi pi-circle-fill text-green-500 animate-pulse"></i>
  <span>Live data â€¢ Updated {{getLastUpdateTime()}}</span>
</div>

<!-- Loading State -->
<div *ngIf="loading" class="grid">
  <div class="col-12 sm:col-6 lg:col" *ngFor="let i of [1,2,3,4,5]">
    <div class="kpi-card custom-card h-full p-4">
      <div class="flex align-items-center justify-content-between mb-3">
        <div class="bg-surface-300 border-round-full" style="width: 48px; height: 48px;"></div>
        <div class="bg-surface-300 border-round" style="width: 60px; height: 20px;"></div>
      </div>
      <div class="bg-surface-300 border-round mb-2" style="width: 100px; height: 36px;"></div>
      <div class="bg-surface-300 border-round mb-2" style="width: 80px; height: 16px;"></div>
      <div class="bg-surface-300 border-round" style="width: 100%; height: 4px;"></div>
    </div>
  </div>
</div>