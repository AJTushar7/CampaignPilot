<!-- Enhanced KPI Cards with Fixed Layout -->
<div class="grid" style="margin-left: -0.5rem; margin-right: -0.5rem;">
  <div class="col-12 sm:col-6 lg:col-2" 
       *ngFor="let kpi of kpiMetrics; let i = index"
       style="padding-left: 0.5rem; padding-right: 0.5rem; margin-bottom: 1rem;">
    
    <p-card styleClass="h-full">
      <div class="p-4">
        <!-- KPI Card Header -->
        <div class="flex align-items-center justify-content-between mb-3">
          <div [class]="'bg-' + kpi.color + '-50 border-round-full p-2'" style="width: 40px; height: 40px; display: flex; align-items: center; justify-content: center;">
            <i class="pi" [ngClass]="[kpi.icon, 'text-' + kpi.color + '-600']"></i>
          </div>
          <div class="flex align-items-center gap-1" [ngClass]="getTrendColor(kpi.growth)">
            <i class="pi text-xs" [ngClass]="getTrendIcon(kpi.growth)"></i>
            <span class="text-xs font-bold">{{kpi.growth}}</span>
          </div>
        </div>

        <!-- KPI Data -->
        <div class="kpi-content">
          <div class="kpi-value text-2xl font-bold mb-1 text-900">
            {{kpi.value}}
          </div>
          <div class="kpi-label text-sm text-600">
            {{kpi.label}}
          </div>
          
          <!-- Simple Progress Bar -->
          <div class="mt-2">
            <div class="bg-surface-200 border-round" style="height: 3px; width: 100%;">
              <div class="border-round" 
                   [class]="'bg-' + kpi.color + '-500'"
                   [style]="{'width': getProgressWidth(i) + '%', 'height': '100%'}">
              </div>
            </div>
          </div>
        </div>
      </div>
    </p-card>
  </div>
</div>

<!-- Real-time Update Indicator -->
<div class="flex align-items-center justify-content-center gap-2 mt-3 text-xs text-500" *ngIf="!loading">
  <i class="pi pi-circle-fill text-green-500"></i>
  <span>Live data â€¢ Updated {{getLastUpdateTime()}}</span>
</div>

<!-- Loading State -->
<div *ngIf="loading" class="grid" style="margin-left: -0.5rem; margin-right: -0.5rem;">
  <div class="col-12 sm:col-6 lg:col-2" 
       *ngFor="let i of [1,2,3,4,5]"
       style="padding-left: 0.5rem; padding-right: 0.5rem; margin-bottom: 1rem;">
    <p-card styleClass="h-full">
      <div class="p-4">
        <div class="flex align-items-center justify-content-between mb-3">
          <div class="bg-surface-300 border-round-full skeleton-loader" style="width: 40px; height: 40px;"></div>
          <div class="bg-surface-300 border-round skeleton-loader" style="width: 60px; height: 20px;"></div>
        </div>
        <div class="bg-surface-300 border-round mb-2 skeleton-loader" style="width: 100px; height: 32px;"></div>
        <div class="bg-surface-300 border-round mb-2 skeleton-loader" style="width: 80px; height: 16px;"></div>
        <div class="bg-surface-300 border-round skeleton-loader" style="width: 100%; height: 3px;"></div>
      </div>
    </p-card>
  </div>
</div>